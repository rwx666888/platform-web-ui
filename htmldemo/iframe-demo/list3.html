<!doctype html>
<html>

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        <title>list(2分栏)</title>

        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <!--<link href="../../font-awesome/css/font-awesome.css" rel="stylesheet">-->
        <link href="../../css/iconfont.css" rel="stylesheet">

        <link href="../../css/plugins/iCheck/custom.css" rel="stylesheet">
        <link href="../../css/plugins/dataTables/datatables.min.css" rel="stylesheet">
        <link href="../../css/animate.css" rel="stylesheet">
        <link href="../../css/style.css" rel="stylesheet">
        <style>
            .table-tr-curbox {
                position: relative;
                padding: 15px 1px;
            }
            
            .table-tr-curbox .cus-tr-bar {
                display: none;
                position: absolute;
                top: 106px;
                left: -32px;
                width: 32px;
                height: 33px;
                /*border-top: 2px solid #1ab394;
                border-bottom: 2px solid #1ab394;*/
                background: #fff;
                box-shadow: 0 5px 5px -5px #1ab394 inset, 0px -5px 5px -5px #1ab394 inset;
            }
            
            table.dataTable tbody>tr.js-selected td {
                /*outline: 2px solid #008200;
                background-color: #e9f9fc;*/
                background-color: #fff;
                box-shadow: 0 5px 5px -5px #1ab394 inset, 0px -5px 5px -5px #1ab394 inset;
            }
            
            table.dataTable tbody>tr.js-selected td:first-child {
                box-shadow: 0 5px 5px -5px #1ab394 inset, 0px -5px 5px -5px #1ab394 inset, 5px 0px 5px -5px #1ab394 inset;
            }
        </style>
    </head>

    <body>
        <div class="container-fluid this-event-page ">
            <div class="row">
                <div class="col-sm-12 m-b-sm m-t-sm clearfix">
                    <div class="pull-left">
                        <div class="form-inline">
                            <div class="form-group form-group-sm">
                                <select class="form-control input-sm">
                                    <option value="1">本季度信息量查询</option>
                                    <option value="2">本月信息量查询</option>
                                    <option value="3">本日信息量查询</option>
                                </select>
                            </div>
                            <div class="form-group form-group-sm">
                                <label for="formdemo1">姓名：<a class="tedufont tedu-icon133 cushelpbtn js-helpbtn js-helpmsg" data-helpbtn="#3" data-helpmsg="platform.common.label.help_admin"></a></label>
                                <input type="text" class="form-control js-helpmsg" data-helpmsg="error" id="formdemo1">
                            </div>
                            <div class="form-group form-group-sm">
                                <label for="formdemo2">手机号：</label>
                                <input type="email" class="form-control" id="formdemo2">
                                <a class="tedufont tedu-icon133 cushelpbtn js-helpbtn js-helpmsg" data-helpbtn="#3" data-helpmsg="platform.common.label.help_admin"></a>
                            </div>
                            <button type="button" class="btn btn-success btn-sm" id="demoSearchBtn">搜索</button>
                            <!-- pop按钮 -->
                            <button type="button" class="btn btn-warning btn-sm" id="cus_pop"><i class="glyphicon glyphicon-chevron-down"></i></button>
                            <button type="button" class="btn btn-warning btn-sm" id="cus_pop2"><i class="glyphicon glyphicon-chevron-down"></i></button>
                        </div>
                    </div>
                    <!--<div class="clearfix visible-sm-block visible-xs-block"></div>-->
                    <div class="pull-right">
                        <button class="btn btn-primary btn-sm" type="button" id="cumBtn_add"><i class="glyphicon glyphicon-plus"></i> 新建</button>
                        <button class="btn btn-success btn-sm" type="button" id="cumBtn_edit"><i class="glyphicon glyphicon-pencil"></i> 修改</button>
                        <button class="btn btn-danger btn-sm" type="button" id="cumBtn_ceping"><i class="glyphicon glyphicon-trash"></i> 测评</button>
                        <div id="drop-gengduo" class="dropdown" style="position: relative;display: inline-block;">
                            <button class="btn btn-warning btn-sm" type="button" data-hover="dropdown" id="cumBtn_gengduo"><i class="glyphicon glyphicon-th-list"></i> 更多
                </button>
                            <div class="dropdown-menu p-sm dropdown-menu-right " role="menu">
                                <button class="btn btn-primary btn-sm btn-block" type="button"><i class="glyphicon glyphicon-plus"></i> 新建</button>
                                <button class="btn btn-success btn-sm btn-block" type="button"><i class="glyphicon glyphicon-pencil"></i> 修改</button>
                                <button class="btn btn-info btn-sm btn-block" type="button"><i class="tedufont tedu-icon72"></i> 批量操作</button>
                                <button class="btn btn-danger btn-sm btn-block" type="button" id="cumBtn_paike"><i class="glyphicon glyphicon-trash"></i> 排课</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-4">
                    <table id="example1" class="table table-striped table-bordered nowrap" cellspacing="0" width="100%">
                        <thead>
                            <tr>
                                <th>demo1</th>
                                <th>demo1</th>
                                <th>demo1</th>
                                <th>demo1</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>demo2</td>
                                <td>demo1</td>
                                <td>demo1</td>
                                <td>demo1</td>
                            </tr>
                            <tr>
                                <td>demo3</td>
                                <td>demo1</td>
                                <td>demo1</td>
                                <td>demo1</td>
                            </tr>
                            <tr>
                                <td>demo4</td>
                                <td>demo1</td>
                                <td>demo1</td>
                                <td>demo1</td>
                            </tr>
                            <tr>
                                <td>demo5</td>
                                <td>demo1</td>
                                <td>demo1</td>
                                <td>demo1</td>
                            </tr>
                            <tr>
                                <td>demo6</td>
                                <td>demo1</td>
                                <td>demo1</td>
                                <td>demo1</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-sm-8">
                    <div class="table-tr-curbox panel panel-primary" id="this_panel_box">
                        <iframe src="list3-1.html" height="100%" width="100%" frameborder="0" style="min-height: 400px;" name="right_iframe" id="right_iframe" allowtransparency="yes"></iframe>
                        <div class="cus-tr-bar" id="cus_tr_bar01"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mainly scripts -->
        <script src="../../js/jquery-2.1.1.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script src="../../js/bootstrap-plugins-custom.js"></script>
        <script src="../../js/plugins/layer/layer.js"></script>
        <script src="../../i18n/zh-CN.js"></script>
        <!-- Custom and plugin javascript -->
        <script src="../../js/plugins/datatables/datatables.min.js"></script>
        <script src="../../js/subindex.js"></script>

        <!-- demo 演示使用 -->
        <script src="../../js/jquery.mockjax.min.js"></script>
        <script src="../../demo-data.js"></script>
        <script>
            $(document).ready(function() {
                console.log('0', $('#example1 tr').eq(2).offset())
                var $cus_tr_bar = $('#cus_tr_bar01');

                COM_TOOLS.DT_init('example1', [
                    {
                        "data": "first_name",
                        "title": '标题1'
                    }, {
                        "data": "last_name",
                        "title": '标题2'
                    }, {
                        "data": "office",
                        "title": '标题4',
                        "className": "text-center"
                    }, {
                        "data": "start_date",
                        "title": '标题5'
                    }
                ], '/dt/api', 'get', {},{
                    jsInitComplete: function(){
                        make_fn(this);
                        $(COM_TOOLS.DT_getNode(this, 'body')).children('tr').eq(0).trigger('click.cus');
                    },
                    jsDrawCallback:function() {  console.log('222')
                        $(COM_TOOLS.DT_getNode(this, 'body')).children('tr').eq(0).trigger('click.cus');
                    },
                    selectStyle: 'api',
                    other:{
                        //pageLength: 2
                    }
                });

                function make_fn(dt) { //左右交互
                    var $tbody_ = $(COM_TOOLS.DT_getNode(dt, 'body'));
                    var $wrap_ = $(COM_TOOLS.DT_getNode(dt, 'container'));
                    console.log('$wrap_',$wrap_)
                    var $panelBox_ = $('#this_panel_box');
                    var offset_p = $panelBox_.offset();
                    var borderWidth_p = parseInt($panelBox_.css('border-left-width')) || 0; //右侧容器左边框宽度
                    var borderWidth_b = parseInt($tbody_.parent('table').css('border-right-width')) || 0; //表格右边框宽度
                    var margin_bottom_ = parseInt($panelBox_.css('margin-bottom')) || 0; 
                    $('#right_iframe').css('min-height',$(document).height() - offset_p.top - margin_bottom_ -45 + 'px');
                    
                    console.log($(document).height() , offset_p.top , margin_bottom_)
                    
                    $tbody_.off('click.cus').on('click.cus', 'tr', function() {
                        var $this = $(this);
                        console.log('hhh', $this.hasClass('js-selected'));
                        if($this.hasClass('js-selected')){
                            // 只适用于 无rowid的情况，本地初始化 自动编排rowid
                            return false;
                        }
                        var offset_b = $this.offset(),
                            outWidth_b = $this.outerWidth();
                        var wrap_width = $wrap_.width();
                        var $first_td = $this.children('td');
                        var first_td_tw = parseInt($this.children('td').css('border-top-width')) || 0;
                        var height_ = $this.children('td').innerHeight() + first_td_tw;
                        //console.log(offset_p.left , offset_b.left , wrap_width , borderWidth_b , borderWidth_p)
                        var diff_w = Math.ceil(offset_p.left - offset_b.left - wrap_width + borderWidth_b + borderWidth_p);
                        $cus_tr_bar.css({
                            width: diff_w + 'px',
                            height: height_ - first_td_tw + 'px',
                            left: -diff_w + 'px',
                            top: offset_b.top - offset_p.top - (1 - first_td_tw) + 'px',
                            display: 'block'
                        });
                        $this.siblings().removeClass('js-selected').end().addClass('js-selected');
                        console.log(COM_TOOLS.DT_getRowsSourceData(dt, this, 'position')[0]); //获取当前行数据[position]
                        //$('#right_iframe').attr('src','');
                    });

                }

            });
        </script>
    </body>

</html>